@using TalepDestekCore.Areas.RequestOfficer.Models
@model RequestsForOfficerViewModel
@{
	ViewData["Title"] = "Requests";
	Layout = "~/Views/Shared/_RequestOfficerLayout.cshtml";
	int count = 0;
}

<div class="page-header row no-gutters py-4">
	<div class="col-12 col-sm-4 text-center text-sm-left mb-0">
		<span class="text-uppercase page-subtitle">Gelen Talepler</span>
		<div class="btn-group" role="group" aria-label="Request Filter">
			<a href="@Url.Action("Requests", new { showInactiveRequests = false })" class="btn btn-primary">Aktif Talepler</a>
			<a href="@Url.Action("Requests", new { showInactiveRequests = true })" class="btn btn-secondary">Sonuçlanmış Talepler</a>
		</div>
	</div>
</div>

@if (!Model.ShowInactiveRequests)
{
	<div class="row">
		<div class="col">
			<div class="card card-small mb-4">
				<div class="card-header border-bottom">
					<h6 class="m-0">Aktif Talepler</h6>
				</div>
				<div class="card-body p-0 pb-2 text-center">
					<table class="table mb-0">
						<thead class="bg-light">
							<tr>
								<th scope="col" class="border-0">#</th>
								<th scope="col" class="border-0">Talep No</th>
								<th scope="col" class="border-0">Talep Birimi</th>
								<th scope="col" class="border-0">Talep Tarihi</th>
								<th scope="col" class="border-0">Talep Eden Kişi</th>
								<th scope="col" class="border-0">Talep Başlığı</th>
								<th scope="col" class="border-0">Durum</th>
								<th scope="col" class="border-0">İşlemler</th>
							</tr>
						</thead>
						<tbody>
							@if (Model.ActiveRequests.Any())
							{
								@foreach (var item in Model.ActiveRequests)
								{
									count++;
									<tr>
										<td>@count</td>
										<td><span class="font-weight-bold ">@item.RequestID</span></td>
										<td><span class="font-weight-bold text-black">@item.Unit.UnitName</span></td>
										<td><i class="far fa-clock text-success"></i> @item.RequestDate.ToString("d MMM yyyy-HH:mm")</td>
										<td><span class="font-weight-bold text-black">@item.User.Name @item.User.Surname</span></td>
										<td>@item.RequestTitle</td>
										<td>
											@{
												string statusClass = "";
												string iconClass = "";
												string statusText = item.Activity.ActivityName;

												switch (item.RequestLastActivityID)
												{
													case 1: // Beklemede
														statusClass = "text-warning";
														iconClass = "fas fa-clock"; // Saat simgesi
														break;
													case 2: // İşlem Devam Ediyor
														statusClass = "text-primary";
														iconClass = "fas fa-spinner"; // Devam eden işlem simgesi
														break;
													case 3: // İptal Edildi
														statusClass = "text-danger";
														iconClass = "fas fa-times"; // Çarpı işareti
														break;
													case 4: // Olumlu Sonuçlandı
														statusClass = "text-success";
														iconClass = "fas fa-check"; // Yeşil tik
														break;
													case 5: // Olumsuz Sonuçlandı
														statusClass = "text-danger";
														iconClass = "fas fa-times"; // Kırmızı çarpı işareti
														break;
													default:
														statusClass = "text-secondary"; // Default durum
														iconClass = "fas fa-question"; // Bilinmeyen durum simgesi
														break;
												}
											}
											<span class="@statusClass">
												<i class="@iconClass"></i> @statusText
											</span>
										</td>
										<td><a href="/RequestOfficer/Request/Details/@item.RequestID" class="btn btn-outline-info">İşlem Yap</a>
											<a href="/RequestOfficer/Request/AssignOfficer/@item.RequestID" class="btn btn-outline-warning">Personele Havale Et</a>
										</td>
									</tr>
								}
							}
							else
							{
								<tr>
									<td colspan="8" class="text-danger">Sonuçlanmış Talep Bulunamadı</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
}
else
{
	<div class="row">
		<div class="col">
			<div class="card card-small mb-4">
				<div class="card-header bg-dark border-bottom">
					<h6 class="m-0 text-white">Sonuçlanmış Talepler</h6>
				</div>
				<div class="card-body p-0 pb-2 bg-dark text-center">
					<table class="table mb-0 table-dark">
						<thead class="thead-dark">
							<tr>
								<th scope="col" class="border-0">#</th>
								<th scope="col" class="border-0">Talep No</th>
								<th scope="col" class="border-0">Kategori</th>
								<th scope="col" class="border-0">Talep Başlığı</th>
								<th scope="col" class="border-0">Talep Tarihi</th>
								<th scope="col" class="border-0">Talep Edilen Birim</th>
								<th scope="col" class="border-0">Durum</th>
								<th scope="col" class="border-0">Detaylar</th>
							</tr>
						</thead>
						<tbody>
							@if (Model.InactiveRequests.Any())
							{
								@foreach (var item in Model.InactiveRequests)
								{
									count = 0;
									count++;
									<tr>
										<td>@count</td>
										<td><span class="font-weight-bold ">@item.RequestID</span></td>
										<td><span class="font-weight-bold text-white">@item.Unit.UnitName</span></td>
										<td><i class="far fa-clock text-success"></i> @item.RequestDate.ToString("d MMM yyyy-HH:mm")</td>
										<td><span class="font-weight-bold text-white">@item.User.Name @item.User.Surname</span></td>
										<td>@item.RequestTitle</td>
										<td>
											@{
												string statusClass = "";
												string iconClass = "";
												string statusText = item.Activity.ActivityName;

												switch (item.RequestLastActivityID)
												{
													case 1: // Beklemede
														statusClass = "text-warning";
														iconClass = "fas fa-clock"; // Saat simgesi
														break;
													case 2: // İşlem Devam Ediyor
														statusClass = "text-primary";
														iconClass = "fas fa-spinner"; // Devam eden işlem simgesi
														break;
													case 3: // İptal Edildi
														statusClass = "text-danger";
														iconClass = "fas fa-times"; // Çarpı işareti
														break;
													case 4: // Olumlu Sonuçlandı
														statusClass = "text-success";
														iconClass = "fas fa-check"; // Yeşil tik
														break;
													case 5: // Olumsuz Sonuçlandı
														statusClass = "text-danger";
														iconClass = "fas fa-times"; // Kırmızı çarpı işareti
														break;
													default:
														statusClass = "text-secondary"; // Default durum
														iconClass = "fas fa-question"; // Bilinmeyen durum simgesi
														break;
												}
											}
											<span class="@statusClass">
												<i class="@iconClass"></i> @statusText
											</span>
										</td>
										<td><a href="/RequestOfficer/Request/Details/@item.RequestID" class="btn btn-outline-info">İşlem Yap</a></td>
									</tr>
								}
							}
							else
							{
								<tr>
									<td colspan="8" class="text-danger">Sonuçlanmış Talep Bulunamadı</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
}


